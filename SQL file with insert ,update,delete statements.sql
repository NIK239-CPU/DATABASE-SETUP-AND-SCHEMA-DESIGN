--TASK 2 : DATA INSERTION AND HANDLING 
-- SQL FILE WITH INSERT,UPDATE,DELETE ,STATEMENTS
--INSERT INTO
-- INSERT INTO AUTHORS

-- AUTHORS TABLE – INSERT 4 ROWS (1 WITH NULL COUNTRY)

INSERT INTO AUTHORS (AUTHORID, NAME, COUNTRY) VALUES
(1, 'J.K. ROWLING', 'UK'),
(2, 'GEORGE ORWELL', NULL),
(3, 'JANE AUSTEN', 'UK'),
(4, 'MARK TWAIN', 'USA');

-- BOOK TABLE – INSERT 5 ROWS (1 WITH NULL AUTHORID, 1 WITH NULL ISBN)

INSERT INTO BOOK (BOOKID, TITLE, AUTHORID, PUBLISHEDYEAR, ISBN) VALUES
(101, 'HARRY POTTER', 1, 1997, 'ISBN001'),
(102, '1984', 2, 1949, 'ISBN002'),
(103, 'PRIDE AND PREJUDICE', 3, 1813, NULL),
(104, 'ADVENTURES OF HUCKLEBERRY FINN', 4, 1884, 'ISBN004'),
(105, 'UNKNOWN BOOK', NULL, 2020, 'ISBN005');  -- NO AUTHOR ASSIGNED


---MEMBERS TABLE – INSERT 4 ROWS (1 WITH NULL EMAIL)

INSERT INTO MEMBERS (MEMBERID, FULLNAME, EMAIL) VALUES
(201, 'ALICE SMITH', 'ALICE@EXAMPLE.COM'),
(202, 'BOB JOHNSON', NULL),
(203, 'CHARLIE BROWN', 'CHARLIE@EXAMPLE.COM'),
(204, 'DAISY MILLER', 'DAISY@EXAMPLE.COM');


-- LENDING TABLE – INSERT 5 ROWS (2 WITH NULL RETURN DATE)

INSERT INTO LENDING (LENDINGID, BOOKID, MEMBERID, ISSUEDATE, RETURNDATE) VALUES
(301, 101, 201, '2025-06-01', '2025-06-15'),
(302, 102, 202, '2025-06-05', NULL),  -- NOT RETURNED YET
(303, 103, 203, '2025-06-10', '2025-06-20'),
(304, 104, 204, '2025-06-12', NULL),  -- NOT RETURNED YET
(305, 105, 201, '2025-06-18', '2025-06-25');

-- UPDATE STATEMENTS

-- UPDATE MISSING MEMBER EMAIL
UPDATE MEMBERS
SET EMAIL = 'BOB123@MAIL.COM'
WHERE MEMBERID = 202;

-- UPDATE BOOK TO ASSIGN AUTHOR
UPDATE BOOK
SET AUTHORID = 3
WHERE BOOKID = 105;


---DELETE STATEMENTS

-- DELETE LENDING WHERE RETURNDATE IS NULL
DELETE FROM LENDING
WHERE RETURNDATE IS NULL;

-- DELETE BOOKS WITH NULL ISBN
DELETE FROM BOOK
WHERE ISBN IS NULL;

--UPDATE QUERIES (WITH WHERE CLAUSE AND NULL HANDLING)
--UPDATE AUTHOR COUNTRY
UPDATE AUTHORS
SET COUNTRY = 'UNITED KINGDOM'
WHERE NAME = 'GEORGE ORWELL' AND COUNTRY IS NULL;

--UPDATE BOOK AVAILABILITY YEAR
UPDATE BOOK
SET PUBLISHEDYEAR = 2001
WHERE TITLE = 'HARRY POTTER';

--UPDATE MISSING MEMBER EMAIL
UPDATE MEMBERS
SET EMAIL = 'BOB123@EXAMPLE.COM'
WHERE FULLNAME = 'BOB' AND EMAIL IS NULL;

--UPDATE BOOK AUTHOR IF AUTHORID IS NULL
UPDATE BOOK
SET AUTHORID = 3
WHERE BOOKID = 105 AND AUTHORID IS NULL;

--SET RETURN DATE FOR RETURNED BOOKS
UPDATE LENDING
SET RETURNDATE = '2025-06-25'
WHERE RETURNDATE IS NULL;


--DELETE QUERIES (WITH WHERE CLAUSE)
--DELETE A MEMBER BY ID
DELETE FROM MEMBERS
WHERE MEMBERID = 202;

-- DELETE BOOKS WITH NULL ISBN
DELETE FROM BOOK
WHERE ISBN IS NULL;

--DELETE LENDING ENTRIES WITH NULL RETURN DATE
DELETE FROM LENDING
WHERE RETURNDATE IS NULL;

-- DELETE BOOKS WRITTEN BY A SPECIFIC AUTHOR
DELETE FROM BOOK
WHERE AUTHORID = (SELECT AUTHORID FROM AUTHORS WHERE NAME = 'MARK TWAIN');

-- DELETE ORPHAN BOOKS (BOOKS WITH NULL AUTHORID)
DELETE FROM BOOK
WHERE AUTHORID IS NULL;

